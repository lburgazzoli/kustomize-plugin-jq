replacements:
  - source:
        apiVersion: v1
        kind: ConfigMap
        name: foo-config
    when:
      expression: .data.configuration.resources.type == 'fixed'
    targets:
      - select:
          apiVersion: apps/v1
          kind: Deployment
          name: foo-deployment
        replacements:
          - selector: '.spec.template.spec.containers | select(.name == "controller") | .resources.limits'
            with: '.spec.configuration.resources.fixed.resources.limits'